---
id: StoragePersister
title: StoragePersister
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: StoragePersister\<TState\>

Defined in: persister.ts:126

A persister that saves state to browser local/session storage.

The persister can use either localStorage (persists across browser sessions) or
sessionStorage (cleared when browser tab/window closes). State is automatically
serialized to JSON when saving and deserialized when loading.

Optionally, a `buster` string can be provided to force cache busting by storing it in the value.
Optionally, a `maxAge` (in ms) can be provided to expire the stored state after a certain duration.
Optionally, callbacks can be provided to run after state is saved or loaded.

## Example

```ts
const persister = new StoragePersister({
  key: 'my-rate-limiter',
  storage: window.localStorage,
  buster: 'v2',
  maxAge: 1000 * 60 * 60, // 1 hour
  onSaveState: (key, state) => console.log('State saved:', key, state),
  onLoadState: (key, state) => console.log('State loaded:', key, state),
  onLoadStateError: (key, error) => console.error('Error loading state:', key, error),
  onSaveStateError: (key, error) => console.error('Error saving state:', key, error)
})
const rateLimiter = new RateLimiter(fn, {
  persister,
  limit: 5,
  window: 1000
})
```

## Extends

- [`Persister`](../persister.md)\<`TState`\>

## Type Parameters

â€¢ **TState**

## Constructors

### new StoragePersister()

```ts
new StoragePersister<TState>(options): StoragePersister<TState>
```

Defined in: persister.ts:128

#### Parameters

##### options

[`StoragePersisterOptions`](../../interfaces/storagepersisteroptions.md)\<`TState`\>

#### Returns

[`StoragePersister`](../storagepersister.md)\<`TState`\>

#### Overrides

[`Persister`](../persister.md).[`constructor`](../Persister.md#constructors)

## Properties

### key

```ts
readonly key: string;
```

Defined in: persister.ts:24

#### Inherited from

[`Persister`](../persister.md).[`key`](../Persister.md#key-1)

## Methods

### getOptions()

```ts
getOptions(): StoragePersisterOptions<TState>
```

Defined in: persister.ts:146

Returns the current persister options

#### Returns

[`StoragePersisterOptions`](../../interfaces/storagepersisteroptions.md)\<`TState`\>

***

### loadState()

```ts
loadState(key): undefined | TState
```

Defined in: persister.ts:167

#### Parameters

##### key

`string`

#### Returns

`undefined` \| `TState`

#### Overrides

[`Persister`](../persister.md).[`loadState`](../Persister.md#loadstate)

***

### saveState()

```ts
saveState(key, state): void
```

Defined in: persister.ts:150

#### Parameters

##### key

`string`

##### state

`TState`

#### Returns

`void`

#### Overrides

[`Persister`](../persister.md).[`saveState`](../Persister.md#savestate)

***

### setOptions()

```ts
setOptions(newOptions): void
```

Defined in: persister.ts:139

Updates the persister options

#### Parameters

##### newOptions

`Partial`\<[`StoragePersisterOptions`](../../interfaces/storagepersisteroptions.md)\<`TState`\>\>

#### Returns

`void`
