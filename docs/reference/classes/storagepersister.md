---
id: StoragePersister
title: StoragePersister
---

<!-- DO NOT EDIT: this page is autogenerated from the type comments -->

# Class: StoragePersister\<TState\>

Defined in: [storage-persister.ts:116](https://github.com/TanStack/pacer/blob/main/packages/persister/src/storage-persister.ts#L116)

A persister that saves state to browser local/session storage.

The persister can use either localStorage (persists across browser sessions) or
sessionStorage (cleared when browser tab/window closes). State is automatically
serialized to JSON when saving and deserialized when loading.

Optionally, a `buster` string can be provided to force cache busting by storing it in the value.
Optionally, a `maxAge` (in ms) can be provided to expire the stored state after a certain duration.
Optionally, callbacks can be provided to run after state is saved or loaded.

## Example

```ts
const persister = new StoragePersister({
  // required
  key: 'my-rate-limiter',
  storage: window.localStorage,
  // optional
  buster: 'v2',
  maxAge: 1000 * 60 * 60, // 1 hour
  stateTransform: (state) => ({
    // Only persist specific parts of the state
    count: state.count,
    lastReset: state.lastReset,
    // Exclude sensitive or temporary data
  }),
  onSaveState: (key, state) => console.log('State saved:', key, state),
  onLoadState: (key, state) => console.log('State loaded:', key, state),
  onLoadStateError: (key, error) => console.error('Error loading state:', key, error),
  onSaveStateError: (key, error) => console.error('Error saving state:', key, error)
})
```

## Extends

- [`Persister`](../persister.md)\<`TState`\>

## Type Parameters

â€¢ **TState**

## Constructors

### new StoragePersister()

```ts
new StoragePersister<TState>(options): StoragePersister<TState>
```

Defined in: [storage-persister.ts:119](https://github.com/TanStack/pacer/blob/main/packages/persister/src/storage-persister.ts#L119)

#### Parameters

##### options

[`StoragePersisterOptions`](../../interfaces/storagepersisteroptions.md)\<`TState`\>

#### Returns

[`StoragePersister`](../storagepersister.md)\<`TState`\>

#### Overrides

[`Persister`](../persister.md).[`constructor`](../Persister.md#constructors)

## Properties

### key

```ts
readonly key: string;
```

Defined in: [persister.ts:24](https://github.com/TanStack/pacer/blob/main/packages/persister/src/persister.ts#L24)

#### Inherited from

[`Persister`](../persister.md).[`key`](../Persister.md#key-1)

## Methods

### getOptions()

```ts
getOptions(): StoragePersisterOptions<TState>
```

Defined in: [storage-persister.ts:137](https://github.com/TanStack/pacer/blob/main/packages/persister/src/storage-persister.ts#L137)

Returns the current persister options

#### Returns

[`StoragePersisterOptions`](../../interfaces/storagepersisteroptions.md)\<`TState`\>

***

### loadState()

```ts
loadState(): undefined | TState
```

Defined in: [storage-persister.ts:167](https://github.com/TanStack/pacer/blob/main/packages/persister/src/storage-persister.ts#L167)

Loads the state from storage

#### Returns

`undefined` \| `TState`

#### Overrides

```ts
Persister.loadState
```

***

### saveState()

```ts
saveState(state): void
```

Defined in: [storage-persister.ts:144](https://github.com/TanStack/pacer/blob/main/packages/persister/src/storage-persister.ts#L144)

Saves the state to storage

#### Parameters

##### state

`TState`

#### Returns

`void`

#### Overrides

```ts
Persister.saveState
```

***

### setOptions()

```ts
setOptions(newOptions): void
```

Defined in: [storage-persister.ts:130](https://github.com/TanStack/pacer/blob/main/packages/persister/src/storage-persister.ts#L130)

Updates the persister options

#### Parameters

##### newOptions

`Partial`\<[`StoragePersisterOptions`](../../interfaces/storagepersisteroptions.md)\<`TState`\>\>

#### Returns

`void`
